meta {
  name: Update
  type: http
  seq: 1
}

put {
  url: http://127.0.0.1:8001/api/v1/use-cases/{{firstUseCaseId}}/rollout-strategy
  body: json
  auth: bearer
}

auth:bearer {
  token: {{accessToken}}
}

body:json {
  { 
    "state": "WARMUP",
    "configuration": {
        "warmup": {
          "interval_mins": null,
          "interval_sess_req": 10,
          "goals": [
            {
              "flow_id": "ec39fd05-b14b-47c3-b4de-0d485c5c8c86",
              "final_serve_pct": 40
            },
            {
              "flow_id": "2b2b94ec-bda0-49b1-9352-05339c601eff",
              "final_serve_pct": 30
            },
            {
              "flow_id": "95768ada-e76b-486a-b616-03b69d3e850b",
              "final_serve_pct": 30
            }
          ]
        },
        "escape": {
          "rules": [
            {
              "flow_id": "ec39fd05-b14b-47c3-b4de-0d485c5c8c86",
              "min_feedback": 5,
              "lower_score": 2,
              "rollback": [
                {
                  "flow_id": "ec39fd05-b14b-47c3-b4de-0d485c5c8c86",
                  "final_serve_pct": 0
                },
                {
                  "flow_id": "2b2b94ec-bda0-49b1-9352-05339c601eff",
                  "final_serve_pct": 50
                },
                {
                  "flow_id": "95768ada-e76b-486a-b616-03b69d3e850b",
                  "final_serve_pct": 50
                }
              ]
            },
            {
              "flow_id": "2b2b94ec-bda0-49b1-9352-05339c601eff",
              "min_feedback": 5,
              "lower_score": 2,
              "rollback": [
                {
                  "flow_id": "ec39fd05-b14b-47c3-b4de-0d485c5c8c86",
                  "final_serve_pct": 100
                },
                {
                  "flow_id": "2b2b94ec-bda0-49b1-9352-05339c601eff",
                  "final_serve_pct": 0
                },
                {
                  "flow_id": "95768ada-e76b-486a-b616-03b69d3e850b",
                  "final_serve_pct": 0
                }
              ]
            }
          ]
        },
        "adaptive": {
          "min_feedback": 20,
          "max_step_pct": 10,
          "interval_mins": 10
        }
    }
  }
}

settings {
  encodeUrl: true
}
